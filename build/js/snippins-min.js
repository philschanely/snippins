function Snippins(){this.config={template_dir:"tpl",extensions:".tpl.html"},this.snips=[],this.init=function(_config){this.syncConfig(_config);var snippins=this;$("*[data-snip]").each(function(_i,_snip){var $shell=$(_snip);snippins.initSnip($shell)})},this.initSnip=function(_shell){var snip=new Snip(_shell.attr("data-snip"),_shell,this.snips.length+1,this.config);snip.load(),this.snips.push(snip)},this.syncConfig=function(_config){if(void 0!==_config)for(var prop in _config)_config.hasOwnProperty(prop)&&this.config.hasOwnProperty(prop)&&(this.config[prop]=_config[prop])}}function Snip(_name,_shell,_id,_config){this.id=_id,this.name=_name,this.shell=_shell,this.config=_config,this.onloadFunction=null,this.template="",this.append=function(_tplData){this.shell.html(_tplData)},this.getOnloadFunction=function(){var onloadAttr=this.shell.attr("data-snip-onload");void 0!==onloadAttr&&(this.onloadFunction=onloadAttr)},this.inject=function(_data){var fn=this.template,tplWithData=fn(_data);this.append(tplWithData)},this.injectData=function(_dataURL,_params){var snip=this;$.get(_dataURL,_params,function(_data){snip.inject(_data)})},this.load=function(_data){var snip=this,data=void 0===_data?{}:_data;$.get(this.snipPath(),_data,function(_result){snip.template=Handlebars.compile(_result),snip.loaded(snip.template)})},this.loaded=function(_tplData){null!==this.onloadFunction?this[this.onloadFunction](_tplData,this.shell):this.append(_tplData)},this.snipPath=function(){return this.config.template_dir+"/"+this.name+this.config.extensions},this.getOnloadFunction()}Handlebars.registerHelper("date",function(_date,_format){var date=Date.parse(_date);return new Handlebars.SafeString(date.format(_format))});